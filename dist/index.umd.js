/*! For license information please see index.umd.js.LICENSE.txt */
!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.neoRegister=o():e.neoRegister=o()}(this,function(){return function(){"use strict";var e={n:function(o){var r=o&&o.__esModule?function(){return o.default}:function(){return o};return e.d(r,{a:r}),r},d:function(o,r){for(var t in r)e.o(r,t)&&!e.o(o,t)&&Object.defineProperty(o,t,{enumerable:!0,get:r[t]})},o:function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{autoConvertVueComponent:function(){return h},createVue2Component:function(){return y},registerNeoCmp:function(){return j},registerNeoEditorModel:function(){return a}});var r=require("@babel/runtime/helpers/extends"),t=e.n(r);function n(e,o,r){void 0===r&&(r=!0);var t=function(e,o){void 0===o&&(o=!0);var r=e&&e.__super?Object.create(e.__super,{__super:{value:e.__super,writable:!1,enumerable:!1}}):Object.create(Object.prototype);return o&&e&&Object.keys(e).forEach(function(o){return r[o]=e[o]}),r}(e,r);return o&&Object.keys(o).forEach(function(e){return t[e]=o[e]}),t}var i,s,u="[neo-register]";function c(e){return"object"==typeof e&&(e._compiled&&e.components||e.__file&&e.__file.endsWith(".vue"))}function a(e,o,r){if(e&&function(e){var o=!1;if(!e)return!1;var r=new e;return r.label?r.tags&&!Array.isArray(r.tags)?console.error(u+" / registerNeoEditorModel: 自定义组件注册失败，组件分类（tags）格式异常。"):(r.iconUrl||Object.assign(e.prototype,{iconUrl:"https://neo-widgets.bj.bcebos.com/custom-widget.svg"}),o=!0):console.error(u+" / registerNeoEditorModel: 自定义组件注册失败，名称（label）不能为空。"),o}(e)){var n,i,s,c,a,p,d,l,f,m,v,g,w=o||(new e).cmpType;w||console.error(u+" / registerNeoEditorModel: 自定义组件注册失败，cmpType 不能为空。");var b=r||{},y=new e;if(Object.assign(e.prototype,t()({},y,{cmpType:w,custom:!0,tags:null!==(n=null!==(i=b.tags)&&void 0!==i?i:y.tags)&&void 0!==n?n:["自定义组件"],iconUrl:null!==(s=null!==(c=b.iconUrl)&&void 0!==c?c:y.iconSrc)&&void 0!==s?s:"https://neo-widgets.bj.bcebos.com/custom-widget.svg",targetPage:null!==(a=null!==(p=y.targetPage)&&void 0!==p?p:b.targetPage)&&void 0!==a?a:["all"],exposedToDesigner:null===(d=null!==(l=y.exposedToDesigner)&&void 0!==l?l:b.exposedToDesigner)||void 0===d||d,namespace:null!==(f=null!==(m=y.namespace)&&void 0!==m?m:b.namespace)&&void 0!==f?f:"neo-cmp-cli",enableDuplicate:null===(v=null!==(g=y.enableDuplicate)&&void 0!==g?g:b.enableDuplicate)||void 0===v||v})),window&&window.postMessage){var h=function(e,o){return window&&!window.NEOEditorCustomModels&&(window.NEOEditorCustomModels={}),window.NEOEditorCustomModels[e]?(console.error(u+"注册自定义组件模型失败，已存在重名插件("+e+")。"),null):(window.NEOEditorCustomModels[e]=o,e)}(w,e);h&&(console.info(u+"触发注册自定义组件模型("+w+")事件"),window.postMessage({type:"neo-model-register-event",eventMsg:u+"注册一个 neo-editor 自定义组件模型",cmpType:w},"*"))}}}!function(e){e.renderer="renderer",e.formitem="formitem"}(i||(i={})),function(e){e.react="react",e.vue2="vue2",e.vue3="vue3",e.jquery="jquery"}(s||(s={}));var p=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),d=e.n(p),l=require("@babel/runtime/helpers/inheritsLoose"),f=e.n(l),m=require("react"),v=e.n(m),g=require("vue"),w=e.n(g),b=["data"];function y(e){if(e&&("function"==typeof e||"object"==typeof e))return function(o){function r(e,r){var t;return(t=o.call(this,e)||this).domRef=void 0,t.vm=void 0,t.isUnmount=void 0,t.domRef=v().createRef(),t.isUnmount=!1,t.resolveNeoProps=t.resolveNeoProps.bind(t),t}f()(r,o);var i=r.prototype;return i.componentDidMount=function(){var o=this,r=this.resolveNeoProps(),i=r.neoData,s=r.neoMSTData,u=r.neoFunc,c=e="function"==typeof e?new e:e,a=c.data,p=d()(c,b),l=n("function"==typeof a?a():a,i);this.vm=new(w())(t()({},p,{data:function(){return l},props:n(u,t()({},p.props||{},s))})),Object.keys(u).forEach(function(e){o.vm.$props[e]=u[e]}),this.domRef.current&&this.domRef.current.appendChild(this.vm.$mount().$el)},i.componentDidUpdate=function(){var e=this;if(!this.isUnmount){var o=this.resolveNeoProps().neoData;this.vm&&(Object.keys(o).forEach(function(r){e.vm[r]=o[r]}),this.vm.$forceUpdate())}},i.componentWillUnmount=function(){this.isUnmount=!0,this.vm&&this.vm.$destroy()},i.resolveNeoProps=function(){var e=this,o={},r={},t={};return Object.keys(this.props).forEach(function(n){var i,s=e.props[n];"function"==typeof s?o[n]=s:(i=s)&&(i.$treenode||i.$mstObservable||i.$modelType||i.$modelId||"[object Proxy]"===Object.prototype.toString.call(i))?t[n]=s:r[n]=s}),{neoData:r,neoMSTData:t,neoFunc:o}},i.reload=function(){this.vm&&this.vm.reload?this.vm.reload():console.warn("自定义组件暂不支持reload动作。")},i.doAction=function(e,o){this.vm&&this.vm.doAction?this.vm.doAction(e,o):console.warn("自定义组件中不存在 doAction。")},i.render=function(){return v().createElement("div",{ref:this.domRef})},r}(v().Component)}function h(e){return c(e)?y(e):e}function j(e,o){if(e){var r,t={cmpType:"",usage:i.renderer,weight:0};if(o&&(r=o,"String"===Object.prototype.toString.call(r).slice(8,-1))?Object.assign(t,{cmpType:o}):Object.assign(t,o),t&&!t.cmpType)console.error(u+" / registerNeoCmp: 自定义组件注册失败，cmpType 不能为空。");else{t.framework=t.framework?function(e){var o=s.react;if(!e)return o;var r=e.toLowerCase().trim();switch(r){case"jquery":case"jq":r=s.jquery;break;case"vue2":case"vue 2":case"vue2.0":case"vue 2.0":r=s.vue2;break;case"vue":case"vue3":case"vue 3":case"vue3.0":case"vue 3.0":r=s.vue3,console.error(u+" 暂不支持 vue3.0 技术栈。");break;default:r=s.react}return r}(t.framework):c(e)?"vue2":"react",t.usage=function(e){var o=i.renderer;if(!e)return o;var r=e.toLowerCase().trim();switch(r){case"renderer":case"renderers":default:r=i.renderer;break;case"formitem":case"form-item":case"form item":r=i.formitem}return r}(t.usage);var n={react:function(e){return e},vue2:y,vue3:y}[t.framework](e);if({renderer:function(){},formitem:function(){}}[t.usage]){if(window&&window.postMessage){var a=(p=t.cmpType,d={cmpType:t.cmpType,weight:t.weight,usage:t.usage,framework:t.framework,component:n,config:t},window&&!window.NeoCustomCmps&&(window.NeoCustomCmps={}),window.NeoCustomCmps[p]?(console.error(u+" / registerNeoCmp: 自定义组件注册失败，已存在重名渲染器("+p+")。"),null):(window.NeoCustomCmps[p]=d,p));a&&(console.info(u+"触发注册自定义组件("+a+")事件"),window.postMessage({type:"neo-cmp-register-event",eventMsg:u+"注册一个自定义组件",neoRenderer:{cmpType:a,weight:t.weight,usage:t.usage,config:t}},"*"))}}else console.error(u+" / registerNeoCmp: 自定义组件注册失败，暂不支持 "+t.usage+" 组件类型。")}}var p,d}return o}()});