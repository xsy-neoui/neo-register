/*! For license information please see index.umd.js.LICENSE.txt */
!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.neoRegister=o():e.neoRegister=o()}(this,function(){return function(){"use strict";var e={n:function(o){var t=o&&o.__esModule?function(){return o.default}:function(){return o};return e.d(t,{a:t}),t},d:function(o,t){for(var r in t)e.o(t,r)&&!e.o(o,r)&&Object.defineProperty(o,r,{enumerable:!0,get:t[r]})},o:function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},o={};e.r(o),e.d(o,{autoConvertVueComponent:function(){return h},createVue2Component:function(){return y},registerNeoCmp:function(){return j},registerNeoEditorModel:function(){return a}});var t=require("@babel/runtime/helpers/extends"),r=e.n(t);function n(e,o,t){void 0===t&&(t=!0);var r=function(e,o){void 0===o&&(o=!0);var t=e&&e.__super?Object.create(e.__super,{__super:{value:e.__super,writable:!1,enumerable:!1}}):Object.create(Object.prototype);return o&&e&&Object.keys(e).forEach(function(o){return t[o]=e[o]}),t}(e,t);return o&&Object.keys(o).forEach(function(e){return r[e]=o[e]}),r}var i,s,u="[neo-register]";function c(e){return"object"==typeof e&&(e._compiled&&e.components||e.__file&&e.__file.endsWith(".vue"))}function a(e,o,t){if(e&&function(e){var o=!1;if(!e)return!1;var t=new e;return t.label?t.tags&&!Array.isArray(t.tags)?console.error(u+" / registerNeoEditorModel: 自定义组件注册失败，组件分类（tags）格式异常。"):(t.iconUrl||Object.assign(e.prototype,{iconUrl:"https://neo-widgets.bj.bcebos.com/custom-widget.svg"}),o=!0):console.error(u+" / registerNeoEditorModel: 自定义组件注册失败，名称（label）不能为空。"),o}(e)){var n,i,s,c,a,l,d,p,f,m,v,g,w,b,y=o||(new e).cmpType;y||console.error(u+" / registerNeoEditorModel: 自定义组件注册失败，cmpType 不能为空。");var h=t||{},j=new e;if(Object.assign(e.prototype,r()({},j,{cmpType:y,custom:!0,tags:null!==(n=null!==(i=h.tags)&&void 0!==i?i:j.tags)&&void 0!==n?n:["自定义组件"],iconUrl:null!==(s=null!==(c=h.iconUrl)&&void 0!==c?c:j.iconSrc)&&void 0!==s?s:"https://neo-widgets.bj.bcebos.com/custom-widget.svg",targetPage:null!==(a=null!==(l=j.targetPage)&&void 0!==l?l:h.targetPage)&&void 0!==a?a:["all"],targetDevice:null!==(d=null!==(p=j.targetDevice)&&void 0!==p?p:h.targetDevice)&&void 0!==d?d:"all",exposedToDesigner:null===(f=null!==(m=j.exposedToDesigner)&&void 0!==m?m:h.exposedToDesigner)||void 0===f||f,namespace:null!==(v=null!==(g=j.namespace)&&void 0!==g?g:h.namespace)&&void 0!==v?v:"neo-cmp-cli",enableDuplicate:null===(w=null!==(b=j.enableDuplicate)&&void 0!==b?b:h.enableDuplicate)||void 0===w||w})),window&&window.postMessage){var O=function(e,o){return window&&!window.NEOEditorCustomModels&&(window.NEOEditorCustomModels={}),window.NEOEditorCustomModels[e]?(console.error(u+"注册自定义组件模型失败，已存在重名插件("+e+")。"),null):(window.NEOEditorCustomModels[e]=o,e)}(y,e);O&&(console.info(u+"触发注册自定义组件模型("+y+")事件"),window.postMessage({type:"neo-model-register-event",eventMsg:u+"注册一个 neo-editor 自定义组件模型",cmpType:y},"*"))}}}!function(e){e.renderer="renderer",e.formitem="formitem"}(i||(i={})),function(e){e.react="react",e.vue2="vue2",e.vue3="vue3",e.jquery="jquery"}(s||(s={}));var l=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),d=e.n(l),p=require("@babel/runtime/helpers/inheritsLoose"),f=e.n(p),m=require("react"),v=e.n(m),g=require("vue"),w=e.n(g),b=["data"];function y(e){if(e&&("function"==typeof e||"object"==typeof e))return function(o){function t(e,t){var r;return(r=o.call(this,e)||this).domRef=void 0,r.vm=void 0,r.isUnmount=void 0,r.domRef=v().createRef(),r.isUnmount=!1,r.resolveNeoProps=r.resolveNeoProps.bind(r),r}f()(t,o);var i=t.prototype;return i.componentDidMount=function(){var o=this,t=this.resolveNeoProps(),i=t.neoData,s=t.neoMSTData,u=t.neoFunc,c=e="function"==typeof e?new e:e,a=c.data,l=d()(c,b),p=n("function"==typeof a?a():a,i);this.vm=new(w())(r()({},l,{data:function(){return p},props:n(u,r()({},l.props||{},s))})),Object.keys(u).forEach(function(e){o.vm.$props[e]=u[e]}),this.domRef.current&&this.domRef.current.appendChild(this.vm.$mount().$el)},i.componentDidUpdate=function(){var e=this;if(!this.isUnmount){var o=this.resolveNeoProps().neoData;this.vm&&(Object.keys(o).forEach(function(t){e.vm[t]=o[t]}),this.vm.$forceUpdate())}},i.componentWillUnmount=function(){this.isUnmount=!0,this.vm&&this.vm.$destroy()},i.resolveNeoProps=function(){var e=this,o={},t={},r={};return Object.keys(this.props).forEach(function(n){var i,s=e.props[n];"function"==typeof s?o[n]=s:(i=s)&&(i.$treenode||i.$mstObservable||i.$modelType||i.$modelId||"[object Proxy]"===Object.prototype.toString.call(i))?r[n]=s:t[n]=s}),{neoData:t,neoMSTData:r,neoFunc:o}},i.reload=function(){this.vm&&this.vm.reload?this.vm.reload():console.warn("自定义组件暂不支持reload动作。")},i.doAction=function(e,o){this.vm&&this.vm.doAction?this.vm.doAction(e,o):console.warn("自定义组件中不存在 doAction。")},i.render=function(){return v().createElement("div",{ref:this.domRef})},t}(v().Component)}function h(e){return c(e)?y(e):e}function j(e,o){if(e){var t,r={cmpType:"",usage:i.renderer,weight:0};if(o&&(t=o,"String"===Object.prototype.toString.call(t).slice(8,-1))?Object.assign(r,{cmpType:o}):Object.assign(r,o),r&&!r.cmpType)console.error(u+" / registerNeoCmp: 自定义组件注册失败，cmpType 不能为空。");else{r.framework=r.framework?function(e){var o=s.react;if(!e)return o;var t=e.toLowerCase().trim();switch(t){case"jquery":case"jq":t=s.jquery;break;case"vue2":case"vue 2":case"vue2.0":case"vue 2.0":t=s.vue2;break;case"vue":case"vue3":case"vue 3":case"vue3.0":case"vue 3.0":t=s.vue3,console.error(u+" 暂不支持 vue3.0 技术栈。");break;default:t=s.react}return t}(r.framework):c(e)?"vue2":"react",r.usage=function(e){var o=i.renderer;if(!e)return o;var t=e.toLowerCase().trim();switch(t){case"renderer":case"renderers":default:t=i.renderer;break;case"formitem":case"form-item":case"form item":t=i.formitem}return t}(r.usage);var n={react:function(e){return e},vue2:y,vue3:y}[r.framework](e);if({renderer:function(){},formitem:function(){}}[r.usage]){if(window&&window.postMessage){var a=(l=r.cmpType,d={cmpType:r.cmpType,weight:r.weight,usage:r.usage,framework:r.framework,component:n,config:r},window&&!window.NeoCustomCmps&&(window.NeoCustomCmps={}),window.NeoCustomCmps[l]?(console.error(u+" / registerNeoCmp: 自定义组件注册失败，已存在重名渲染器("+l+")。"),null):(window.NeoCustomCmps[l]=d,l));a&&(console.info(u+"触发注册自定义组件("+a+")事件"),window.postMessage({type:"neo-cmp-register-event",eventMsg:u+"注册一个自定义组件",neoRenderer:{cmpType:a,weight:r.weight,usage:r.usage,config:r}},"*"))}}else console.error(u+" / registerNeoCmp: 自定义组件注册失败，暂不支持 "+r.usage+" 组件类型。")}}var l,d}return o}()});